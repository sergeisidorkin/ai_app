<div class="card shadow-sm mb-3" id="onedrive-panel">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center mb-2">
      {% load ui %}
      <p class="mb-0 fw-semibold d-flex align-items-center fs-6 lh-1">
         {% svg_icon 'onedrive' 'me-2 icon-inline' %}
         Microsoft OneDrive
      </p>
      {% if onedrive_connected %}
        <span class="badge text-bg-success">–ü–æ–¥–∫–ª—é—á–µ–Ω–æ</span>
      {% else %}
        <span class="badge text-bg-secondary">–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ</span>
      {% endif %}
    </div>

    {% if onedrive_connected and selection and selection.item_id %}
      <div class="mb-3">
        <div class="small text-muted">–í—ã–±—Ä–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç</div>
        <div class="d-flex flex-wrap align-items-center gap-2">
          <div>
            {% if selection.is_folder %}üìÅ –ü–∞–ø–∫–∞{% else %}üìÑ –§–∞–π–ª{% endif %}:
            <span class="fw-semibold">{{ selection.item_name }}</span>
            <span class="text-muted">({{ selection.item_path }})</span>
          </div>
          {% if selection.web_url %}
            <a class="btn btn-sm btn-outline-secondary" href="{{ selection.web_url }}" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å</a>
          {% endif %}
          <form method="post" action="{% url 'onedrive_clear' %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-danger"
                    onclick="return confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞/–ø–∞–ø–∫–∏?')">
              –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä
            </button>
          </form>
        </div>
      </div>
    {% else %}
      <div class="mb-3">
        {% if onedrive_connected %}
            <span class="text-muted">–§–∞–π–ª/–ø–∞–ø–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω(–∞)</span>
        {% else %}
            <span class="text-muted">–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ OneDrive, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª/–ø–∞–ø–∫—É.</span>
        {% endif %}
      </div>
    {% endif %}

    <div class="d-flex gap-2">
      {% if onedrive_connected %}
        <a class="btn btn-outline-secondary" href="{% url 'onedrive_pick' %}">–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª/–ø–∞–ø–∫—É</a>
        <form method="post"
              action="{% url 'onedrive_disconnect' %}"
              hx-post="{% url 'onedrive_disconnect' %}"
              hx-target="#connections-pane"
              hx-swap="innerHTML"
              class="d-inline">
          {% csrf_token %}
          <button type="submit"
                  class="btn btn-outline-danger"
                  onclick="return confirm('–û—Ç–∫–ª—é—á–∏—Ç—å OneDrive –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')">
            –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
          </button>
        </form>
      {% else %}
        <a class="btn btn-outline-primary" href="{% url 'onedrive_connect' %}">–ü–æ–¥–∫–ª—é—á–∏—Ç—å</a>
      {% endif %}
    </div>

    <p class="text-muted small mt-2 mb-0">
      –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ .docx ¬´–°–æ–∑–¥–∞—Ç—å¬ª –≤ –±–ª–æ–∫–∞—Ö –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –≤ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç.
    </p>
  </div>
</div>